{"title":"DDSU666型单相电子式电能表切换通讯协议","uid":"7ec57e2123cc48c7af274bbedd7b8f27","slug":"IOT/DDSU666型单相电子式电能表切换通讯协议","date":"2023-02-01T07:22:12.141Z","updated":"2023-02-07T05:15:47.563Z","comments":true,"path":"api/articles/IOT/DDSU666型单相电子式电能表切换通讯协议.json","keywords":"阿里孩舞,五月西恩,Anchor,阁楼麻雀,码农,程序猿,JAVA","cover":"/medias/teemo.png","content":"<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>近期有个物联网对接场景，使用到了正泰DDSU666型单相电子式电能表，该表有两种通信协议，由于项目需要使用ModBus协议对接，且很不幸手里拿到的这只正好是DLT645协议，所以就需要通过串口调试工具手动切换协议。<br>刚开始切换走了不少坑，特此记录下</p></blockquote>\n<h1 id=\"一、确认当前默认通讯协议\"><a href=\"#一、确认当前默认通讯协议\" class=\"headerlink\" title=\"一、确认当前默认通讯协议\"></a>一、确认当前默认通讯协议</h1><p>电表有DLT645、Modbus两种通讯协议，可以观察液晶标识符，先确认当前电表的协议，示例如下：<br>Modbus模式：<br><img src=\"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202302011525146.png\" alt=\"Modbus模式\"><br>DLT645模式：<br><img src=\"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202302011525464.png\" alt=\"DLT645模式\"></p>\n<h1 id=\"二、切换电表通讯协议\"><a href=\"#二、切换电表通讯协议\" class=\"headerlink\" title=\"二、切换电表通讯协议\"></a>二、切换电表通讯协议</h1><p>如果电表默认非Modbus通讯协议，则需要通过串口工具来切换电表通讯协议，具体步骤如下：</p>\n<h2 id=\"1、通过485转USB转接头连接电表485通讯端口\"><a href=\"#1、通过485转USB转接头连接电表485通讯端口\" class=\"headerlink\" title=\"1、通过485转USB转接头连接电表485通讯端口\"></a>1、通过485转USB转接头连接电表485通讯端口</h2><p>注意485接线，7为A口，8为B口，不可接反<br><img src=\"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202302011526743.png\"></p>\n<h2 id=\"2、连接串口\"><a href=\"#2、连接串口\" class=\"headerlink\" title=\"2、连接串口\"></a>2、连接串口</h2><p>将USB端连接Windows电脑，打开电脑控制面板–设备管理，查看当前接入串口号是多少<br><img src=\"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202302011526300.png\" alt=\"控制面板--设备管理\"></p>\n<h2 id=\"3、打开串口调试工具（注意使用管理员启动）\"><a href=\"#3、打开串口调试工具（注意使用管理员启动）\" class=\"headerlink\" title=\"3、打开串口调试工具（注意使用管理员启动）\"></a>3、打开串口调试工具（注意使用管理员启动）</h2><p>注意需要修改的配置项：</p>\n<ul>\n<li>端口选择第二步查看到的COM号，如图为COM3</li>\n<li>波特率选择2400</li>\n<li>数据位选择8</li>\n<li>停止位选择2</li>\n</ul>\n<p><img src=\"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202302011527979.png\" alt=\"串口调试工具配置\"></p>\n<h2 id=\"4、拼接通讯数据\"><a href=\"#4、拼接通讯数据\" class=\"headerlink\" title=\"4、拼接通讯数据\"></a>4、拼接通讯数据</h2><p>官方文档说明如下：<br><img src=\"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202302011528414.png\"><br>以当前电表为例，我们需要处理的数据项为：<br><strong>6869091723052268140E3333353D3533333333333333333</strong><br>其中蓝色字体部分为固定值，红色字体部分为电表的通宵地址，通讯地址来源于电表上的条形码，如图：<br><img src=\"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202302011528048.png\"><br>注意：使用时倒序输入，如上图所示，此时通讯地址为：<strong>690917230522</strong></p>\n<h2 id=\"5、计算校验位\"><a href=\"#5、计算校验位\" class=\"headerlink\" title=\"5、计算校验位\"></a>5、计算校验位</h2><p>串口工具提供了计算功能，输入底4部获取的通讯数据后，点击“校验”，选择“总加和”，点击确定后，软件自动帮我们计算出校验位为9D<br><img src=\"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202302011529023.png\" alt=\"计算校验位\"><br><img src=\"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202302011529654.png\" alt=\"得出校验位\"></p>\n<h2 id=\"6、修改最终发送数据\"><a href=\"#6、修改最终发送数据\" class=\"headerlink\" title=\"6、修改最终发送数据\"></a>6、修改最终发送数据</h2><p>去掉空格，并在末尾补充16，得出最终要发送的数据项：<strong>6869091723052268140E3333353D353333333333333333339D16</strong><br>点击“手动发送”，观察电表变化<br><img src=\"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202302011530579.png\" alt=\"最终发送数据\"></p>\n<h2 id=\"7、验证是否修改成功\"><a href=\"#7、验证是否修改成功\" class=\"headerlink\" title=\"7、验证是否修改成功\"></a>7、验证是否修改成功</h2><p>经过第6步发送数据后，关注电表液晶屏的切换，如出现下图所示展示项，则证明Modbus通讯协议修改成功：<br><img src=\"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202302011530892.png\"></p>\n","text":" 近期有个物联网对接场景，使用到了正泰DDSU666型单相电子式电能表，该表有两种通信协议，由于项目需要使用ModBus协议对接，且很不幸手里拿到的这只正好是DLT645协议，所以就需要通过串口调试工具手动切换协议。刚开始切换走了不少坑，特此记录下 一、确认当前默认通讯协议电表有...","link":"","photos":[],"count_time":{"symbolsCount":855,"symbolsTime":"1 mins."},"categories":[{"name":"IOT","slug":"IOT","count":1,"path":"api/categories/IOT.json"}],"tags":[{"name":"ModBus","slug":"ModBus","count":1,"path":"api/tags/ModBus.json"},{"name":"DLT645","slug":"DLT645","count":1,"path":"api/tags/DLT645.json"},{"name":"IOT","slug":"IOT","count":1,"path":"api/tags/IOT.json"},{"name":"DDSU666","slug":"DDSU666","count":1,"path":"api/tags/DDSU666.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%B8%80%E3%80%81%E7%A1%AE%E8%AE%A4%E5%BD%93%E5%89%8D%E9%BB%98%E8%AE%A4%E9%80%9A%E8%AE%AF%E5%8D%8F%E8%AE%AE\"><span class=\"toc-text\">一、确认当前默认通讯协议</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BA%8C%E3%80%81%E5%88%87%E6%8D%A2%E7%94%B5%E8%A1%A8%E9%80%9A%E8%AE%AF%E5%8D%8F%E8%AE%AE\"><span class=\"toc-text\">二、切换电表通讯协议</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1%E3%80%81%E9%80%9A%E8%BF%87485%E8%BD%ACUSB%E8%BD%AC%E6%8E%A5%E5%A4%B4%E8%BF%9E%E6%8E%A5%E7%94%B5%E8%A1%A8485%E9%80%9A%E8%AE%AF%E7%AB%AF%E5%8F%A3\"><span class=\"toc-text\">1、通过485转USB转接头连接电表485通讯端口</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2%E3%80%81%E8%BF%9E%E6%8E%A5%E4%B8%B2%E5%8F%A3\"><span class=\"toc-text\">2、连接串口</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#3%E3%80%81%E6%89%93%E5%BC%80%E4%B8%B2%E5%8F%A3%E8%B0%83%E8%AF%95%E5%B7%A5%E5%85%B7%EF%BC%88%E6%B3%A8%E6%84%8F%E4%BD%BF%E7%94%A8%E7%AE%A1%E7%90%86%E5%91%98%E5%90%AF%E5%8A%A8%EF%BC%89\"><span class=\"toc-text\">3、打开串口调试工具（注意使用管理员启动）</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#4%E3%80%81%E6%8B%BC%E6%8E%A5%E9%80%9A%E8%AE%AF%E6%95%B0%E6%8D%AE\"><span class=\"toc-text\">4、拼接通讯数据</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#5%E3%80%81%E8%AE%A1%E7%AE%97%E6%A0%A1%E9%AA%8C%E4%BD%8D\"><span class=\"toc-text\">5、计算校验位</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#6%E3%80%81%E4%BF%AE%E6%94%B9%E6%9C%80%E7%BB%88%E5%8F%91%E9%80%81%E6%95%B0%E6%8D%AE\"><span class=\"toc-text\">6、修改最终发送数据</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#7%E3%80%81%E9%AA%8C%E8%AF%81%E6%98%AF%E5%90%A6%E4%BF%AE%E6%94%B9%E6%88%90%E5%8A%9F\"><span class=\"toc-text\">7、验证是否修改成功</span></a></li></ol></li></ol>","author":{"name":"Anchor","slug":"blog-author","avatar":"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202212281657361.png","link":"/","description":"新生代农民工 <br /> 技术无产阶级 <br /> 浪浪山打工人 <br /> @ <b>TG：Alihai5</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Druid监控导致的内存溢出问题定位处理","uid":"9736882d32005a945dbd1b55fb5920ee","slug":"Java/Druid监控导致的内存溢出问题定位处理","date":"2018-08-06T06:03:15.000Z","updated":"2023-01-17T07:32:06.801Z","comments":true,"path":"api/articles/Java/Druid监控导致的内存溢出问题定位处理.json","keywords":"阿里孩舞,五月西恩,Anchor,阁楼麻雀,码农,程序猿,JAVA","cover":"/medias/jks.jpg","text":"0、起因 一台部署于商户私有云中的应用频繁宕机，经查为 OOM，周期大约一周一次，较规律，所谓千里之堤毁于蚁穴，初步怀疑是轻微的内存泄漏不断积累导致的内存溢出，所以再次宕机出现时果断 dump 内存镜像开始分析 1、内存溢出原理 常见内存溢出： 相信通过写 java 程序讨生活的...","link":"","photos":[],"count_time":{"symbolsCount":"8k","symbolsTime":"7 mins."},"categories":[{"name":"JAVA","slug":"JAVA","count":7,"path":"api/categories/JAVA.json"}],"tags":[{"name":"JVM","slug":"JVM","count":2,"path":"api/tags/JVM.json"},{"name":"OOM","slug":"OOM","count":2,"path":"api/tags/OOM.json"},{"name":"Druid","slug":"Druid","count":1,"path":"api/tags/Druid.json"}],"author":{"name":"Anchor","slug":"blog-author","avatar":"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202212281657361.png","link":"/","description":"新生代农民工 <br /> 技术无产阶级 <br /> 浪浪山打工人 <br /> @ <b>TG：Alihai5</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"浪浪山打工人旅游指南（一）Java 面试题【汇总篇】","uid":"c498ccbc5dc4c0c1651c7cd1edb0e954","slug":"浪浪山打工人/浪浪山打工人旅游指南（一）Java 面试题【汇总篇】","date":"2023-01-16T13:58:28.000Z","updated":"2023-01-31T10:20:32.153Z","comments":true,"path":"api/articles/浪浪山打工人/浪浪山打工人旅游指南（一）Java 面试题【汇总篇】.json","keywords":"阿里孩舞,五月西恩,Anchor,阁楼麻雀,码农,程序猿,JAVA","cover":"/medias/lls.jpg","text":" 2023年1月份最新基础汇总篇，Java开发技术栈知识点都有涉及，主要面向1-2年修为的浪浪山小妖，温故而知新旅游前读这一篇就够了 一、基础篇 基础篇可搭配Java 技术栈（基础篇） 食用。 1.1.Java语言有哪些特点 简单易学、有丰富的类库 面向对象（Java最重要的特性...","link":"","photos":[],"count_time":{"symbolsCount":"94k","symbolsTime":"1:25"},"categories":[{"name":"浪浪山打工人","slug":"浪浪山打工人","count":2,"path":"api/categories/浪浪山打工人.json"}],"tags":[{"name":"JAVA","slug":"JAVA","count":4,"path":"api/tags/JAVA.json"},{"name":"Java基础","slug":"Java基础","count":3,"path":"api/tags/Java基础.json"},{"name":"Java面试题","slug":"Java面试题","count":2,"path":"api/tags/Java面试题.json"},{"name":"2023汇总篇","slug":"2023汇总篇","count":1,"path":"api/tags/2023汇总篇.json"}],"author":{"name":"Anchor","slug":"blog-author","avatar":"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202212281657361.png","link":"/","description":"新生代农民工 <br /> 技术无产阶级 <br /> 浪浪山打工人 <br /> @ <b>TG：Alihai5</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}