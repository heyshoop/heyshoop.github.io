{"title":"Druidç›‘æ§å¯¼è‡´çš„å†…å­˜æº¢å‡ºé—®é¢˜å®šä½å¤„ç†","uid":"9736882d32005a945dbd1b55fb5920ee","slug":"Java/Druidç›‘æ§å¯¼è‡´çš„å†…å­˜æº¢å‡ºé—®é¢˜å®šä½å¤„ç†","date":"2018-08-06T06:03:15.000Z","updated":"2023-01-17T07:32:06.801Z","comments":true,"path":"api/articles/Java/Druidç›‘æ§å¯¼è‡´çš„å†…å­˜æº¢å‡ºé—®é¢˜å®šä½å¤„ç†.json","keywords":"é˜¿é‡Œå­©èˆ,äº”æœˆè¥¿æ©,Anchor,é˜æ¥¼éº»é›€,ç å†œ,ç¨‹åºçŒ¿,JAVA","cover":"/medias/jks.jpg","content":"<h1 id=\"0ã€èµ·å› \"><a href=\"#0ã€èµ·å› \" class=\"headerlink\" title=\"0ã€èµ·å› \"></a>0ã€èµ·å› </h1><p>  ä¸€å°éƒ¨ç½²äºå•†æˆ·ç§æœ‰äº‘ä¸­çš„åº”ç”¨é¢‘ç¹å®•æœºï¼Œç»æŸ¥ä¸º OOMï¼Œå‘¨æœŸå¤§çº¦ä¸€å‘¨ä¸€æ¬¡ï¼Œè¾ƒè§„å¾‹ï¼Œæ‰€è°“åƒé‡Œä¹‹å ¤æ¯äºèšç©´ï¼Œåˆæ­¥æ€€ç–‘æ˜¯è½»å¾®çš„å†…å­˜æ³„æ¼ä¸æ–­ç§¯ç´¯å¯¼è‡´çš„å†…å­˜æº¢å‡ºï¼Œæ‰€ä»¥å†æ¬¡å®•æœºå‡ºç°æ—¶æœæ–­ dump å†…å­˜é•œåƒå¼€å§‹åˆ†æ</p>\n<h1 id=\"1ã€å†…å­˜æº¢å‡ºåŸç†\"><a href=\"#1ã€å†…å­˜æº¢å‡ºåŸç†\" class=\"headerlink\" title=\"1ã€å†…å­˜æº¢å‡ºåŸç†\"></a>1ã€å†…å­˜æº¢å‡ºåŸç†</h1><ul>\n<li><p>å¸¸è§å†…å­˜æº¢å‡ºï¼š</p>\n<p>ç›¸ä¿¡é€šè¿‡å†™ java ç¨‹åºè®¨ç”Ÿæ´»çš„äººå¯¹å†…å­˜æº¢å‡ºå¹¶ä¸é™Œç”Ÿï¼Œå…ˆçœ‹ä¸‰å¼ å›¾ï¼š</p>\n</li>\n</ul>\n<p><img src=\"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202212290931807.png\"></p>\n<p>Heap spaceï¼ˆå †ç©ºé—´ï¼‰</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202212290931810.png\"></p>\n<p>Permgenï¼ˆæ°¸ä¹…ä»£ï¼‰</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202212290931194.png\"></p>\n<p>å…ƒç©ºé—´ï¼ˆMetaspaceï¼‰</p>\n<ul>\n<li>JVM å†…å­˜æ¨¡å‹</li>\n</ul>\n<p><img src=\"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202212290932304.png\"></p>\n<p>  Java åº”ç”¨ç¨‹åºåœ¨å¯åŠ¨æ—¶ä¼šæŒ‡å®šæ‰€éœ€è¦çš„å†…å­˜å¤§å°ï¼Œå®ƒè¢«åˆ†å‰²æˆä¸¤ä¸ªä¸åŒçš„åŒºåŸŸï¼š<code>Heap space</code>ï¼ˆå †ç©ºé—´ï¼‰å’Œ<code>Permgen</code>ï¼ˆæ°¸ä¹…ä»£ï¼‰ã€‚</p>\n  <pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token class-name\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>lang<span class=\"token punctuation\">.</span></span>OutOfMemoryError</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>  æ­£å¦‚å­—é¢æ„æ€ï¼Œå½“åº”ç”¨ç¨‹åºè¯•å›¾å‘è¿™ä¸¤ä¸ªç©ºé—´æ·»åŠ æ›´å¤šçš„æ•°æ®ï¼Œä½†å´æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´æ¥å®¹çº³è¿™äº›æ•°æ®æ—¶ï¼Œå°†ä¼šè§¦å‘<code>java.lang.OutOfMemoryError</code>ã€‚</p>\n<ul>\n<li><p>å†…å­˜æº¢å‡ºåŸå› åˆ†æ</p>\n<p>1ã€java.lang.OutOfMemoryError: PermGen space</p>\n<p><code>PermGen space</code>çš„å…¨ç§°æ˜¯<code>Permanent Generation space</code>,æ˜¯æŒ‡å†…å­˜çš„æ°¸ä¹…ä¿å­˜åŒºåŸŸ, è¿™å—å†…å­˜ä¸»è¦æ˜¯è¢« JVM å­˜æ”¾ Class å’Œ Meta ä¿¡æ¯çš„,Class åœ¨è¢« Load æ—¶å°±ä¼šè¢«æ”¾åˆ°<code>PermGen space</code>ä¸­, åŒæ—¶ GC(Garbage Collection)ä¸ä¼šåœ¨ä¸»ç¨‹åºè¿è¡ŒæœŸå¯¹ <code>PermGen space</code>è¿›è¡Œæ¸…ç†ã€‚</p>\n<p>æ‰€ä»¥å¦‚æœä½ çš„åº”ç”¨ä¸­æœ‰å¾ˆå¤š CLASS çš„è¯,å°±å¾ˆå¯èƒ½å‡ºç° PermGen space é”™è¯¯ã€‚</p>\n<p>é€šè¿‡ä¸Šé¢çš„æè¿°å°±å¯ä»¥å¾—å‡ºï¼šå¦‚æœè¦åŠ è½½çš„ class ä¸ jar æ–‡ä»¶å¤§å°è¶…è¿‡-XX:MaxPermSize å°±æœ‰å¯èƒ½ä¼šäº§ç”Ÿ java.lang.OutOfMemoryError: PermGen space ã€‚</p>\n<p>æ¢å¥è¯è¯´-XX:MaxPermSize çš„å¤§å°è¦è¶…è¿‡ class ä¸ jar çš„å¤§å°ã€‚</p>\n<p>2ã€java.lang.OutOfMemoryError: Java heap space</p>\n<p>è™½ç„¶å„ç§ java è™šæ‹Ÿæœºçš„å®ç°æœºåˆ¶ä¸ä¸€,ä½†æ˜¯<code>heap space</code>å†…å­˜æº¢å‡ºäº§ç”Ÿçš„åŸå› ç›¸åŒï¼šé‚£å°±æ˜¯å †å†…å­˜ä¸å¤Ÿè™šæ‹Ÿæœºåˆ†é…äº†ã€‚</p>\n<p>ç”±äºå†…å­˜çš„åˆ†é…æœºåˆ¶ä¸ GC æ˜¯æœ‰è”ç³»çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å†…å­˜ä¸å¤Ÿç”¨æ—¶æœ‰éƒ¨åˆ†å†…å­˜ GC è‚¯å®šæ— æ³•é‡Šæ”¾ï¼Œè€Œæˆ‘ä»¬è¦æ‰¾çš„å°±æ˜¯ä¸ºä»€ä¹ˆ GC é‡Šæ”¾ä¸äº†å †å†…å­˜ã€‚</p>\n<p>æ‰€ä»¥å½“äº§ç”Ÿ<code>heap space</code>å†…å­˜æº¢å‡ºæ—¶ï¼Œå †å†…å­˜ä¸­å¯¹è±¡æ•°é‡è¿‡å¤šçš„å°±å¯èƒ½æ˜¯é—®é¢˜çš„æ ¹æºäº†ã€‚ä¾‹å¤–çš„æƒ…å†µæ˜¯ï¼Œç¨‹åºç¡®å®éœ€è¦é‚£ä¹ˆå¤šå†…å­˜ï¼Œè¿™æ—¶å°±è¦è€ƒè™‘å¢å¤§å †å†…å­˜ã€‚</p>\n</li>\n</ul>\n<h1 id=\"2ã€å†…å­˜æº¢å‡ºæ—¶åº”è¯¥åšä»€ä¹ˆ\"><a href=\"#2ã€å†…å­˜æº¢å‡ºæ—¶åº”è¯¥åšä»€ä¹ˆ\" class=\"headerlink\" title=\"2ã€å†…å­˜æº¢å‡ºæ—¶åº”è¯¥åšä»€ä¹ˆ\"></a>2ã€å†…å­˜æº¢å‡ºæ—¶åº”è¯¥åšä»€ä¹ˆ</h1><ul>\n<li><p>æ”¶é›†æ¡ˆå‘ç°åœºæ•°æ®ï¼Œå°½å¿«æ¢å¤ç³»ç»Ÿ</p>\n<p>è·å–å†…å­˜å¿«ç…§ï¼Œæ ¹æ®é€‚ç”¨åœºæ™¯æœ‰ä»¥ä¸‹ä¸‰ç§æ–¹å¼ï¼š</p>\n<p>1ã€ä½¿ç”¨ jmap å‘½ä»¤åœ¨æ¡ˆå‘ç°åœºæ‰‹åŠ¨ç”Ÿæˆ dump æ–‡ä»¶</p>\n<p><code>jmap -dump:format=b,file=heap.dump \\`pid of java\\`</code></p>\n<p>2ã€ä½¿ç”¨ JVM å‚æ•°è‡ªåŠ¨åœ¨æ¡ˆå‘å½“åœºè·å– dump æ–‡ä»¶</p>\n<p><code>-XX:+HeapDumpOnOutOfMemoryError</code></p>\n<p>3ã€ä½¿ç”¨å…¶å®ƒå·¥å…·è·å– dump æ–‡ä»¶ï¼Œä¸»è¦é’ˆå¯¹æœ¬åœ°å¼€å‘ç¯å¢ƒï¼š</p>\n<p>åˆ†æ <code>Heap Dump</code> çš„å·¥å…·éƒ½å¯ä»¥è·å– <code>Heap Dump</code> æ–‡ä»¶ã€‚<br>æ¯”å¦‚ï¼š<code>jdk</code> è‡ªå¸¦çš„å·¥å…· <code>jvisualvm</code>ã€‚<br>å…¶å®ƒå·¥å…·ï¼š<code>Eclipse memory analyzerï¼ˆjmatï¼‰</code>ã€<code>JProfiler</code> ç­‰ã€‚</p>\n</li>\n<li><p>æœ¬åœ°å¤ç°ä¹‹ jvisualvm çš„ä½¿ç”¨</p>\n<p>æ— è®ºæ˜¯ä¸ºäº†å†ç°æ¡ˆå‘åœºæ™¯è¿˜æ˜¯éªŒè¯ä¿®å¤æ•ˆæœï¼Œéƒ½éœ€è¦æˆ‘ä»¬åœ¨æœ¬åœ°ç¯å¢ƒä¸­ç›‘æ§ JVM çš„è¿è¡Œæƒ…å†µï¼ŒSO ä»¥æˆ‘ç†Ÿæ‚‰çš„<code>jvisualvm</code>ä¸ºä¾‹ï¼Œç®€å•è¯´ä¸‹ä½¿ç”¨æ–¹æ³•</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>VisualVM æä¾›åœ¨ Java è™šæ‹Ÿæœº (Java Virutal Machine, JVM) ä¸Šè¿è¡Œçš„ Java åº”ç”¨ç¨‹åºçš„è¯¦ç»†ä¿¡æ¯ã€‚åœ¨ VisualVM çš„å›¾å½¢ç”¨æˆ·ç•Œé¢ä¸­ï¼Œæ‚¨å¯ä»¥æ–¹ä¾¿ã€å¿«æ·åœ°æŸ¥çœ‹å¤šä¸ª Java åº”ç”¨ç¨‹åºçš„ç›¸å…³ä¿¡æ¯ã€‚ï¼ˆæ‘˜è‡ªå®˜æ–¹ï¼‰<br>ç®€å•è¯´æ¥ï¼ŒVisualVM æ˜¯ä¸€ç§é›†æˆäº†å¤šä¸ª JDK å‘½ä»¤è¡Œå·¥å…·çš„å¯è§†åŒ–å·¥å…·ï¼Œå®ƒèƒ½ä¸ºæ‚¨æä¾›å¼ºå¤§çš„åˆ†æèƒ½åŠ›ã€‚æ‰€æœ‰è¿™äº›éƒ½æ˜¯å…è´¹çš„ï¼å®ƒå›Šæ‹¬çš„å‘½ä»¤è¡Œå·¥å…·åŒ…æ‹¬ jstat, JConsole, jstack, jmap å’Œ jinfoï¼Œè¿™äº›å·¥å…·ä¸ JDK çš„æ ‡å‡†ç‰ˆæœ¬æ˜¯ä¸€è‡´çš„ã€‚ å¯ä»¥ä½¿ç”¨ VisualVM ç”Ÿæˆå’Œåˆ†ææµ·é‡æ•°æ®ã€è·Ÿè¸ªå†…å­˜æ³„æ¼ã€ç›‘æ§åƒåœ¾å›æ”¶å™¨ã€æ‰§è¡Œå†…å­˜å’Œ CPU åˆ†æã€‚å°½ç®¡ VisualVM è‡ªèº«è¦åœ¨ JDK6 è¿™ä¸ªç‰ˆæœ¬ä¸Šè¿è¡Œï¼Œä½†æ˜¯ JDK1.4 ä»¥ä¸Šç‰ˆæœ¬çš„ç¨‹åºå®ƒéƒ½èƒ½ç›‘æ§ã€‚<br>VisualVM çš„ä¸€ä¸ªæœ€å¤§å¥½å¤„å°±æ˜¯ï¼Œå®ƒå·²ç»åœ¨ä½ çš„ JDK bin ç›®å½•é‡Œäº†ï¼Œåªè¦ä½ ä½¿ç”¨çš„æ˜¯ JDK1.6 Update7 ä¹‹åçš„ç‰ˆæœ¬ã€‚ç‚¹å‡»ä¸€ä¸‹ jvisualvm.exe å›¾æ ‡å®ƒå°±å¯ä»¥è¿è¡Œäº†ï¼Œä¹Ÿå¯ä»¥ç»ˆç«¯æˆ–è€… CMD ä¸­ä½¿ç”¨ jvisualvm å‘½ä»¤å¯åŠ¨ã€‚</p></blockquote>\n<p>Jvisualvm æœ¬åœ°è”è°ƒçš„ä¸¤ç§å¸¸ç”¨æ–¹æ³•ï¼š</p>\n<p>1ã€<code>Jvisualvm</code>ä¸<code>IDEA</code>é›†æˆï¼Œ<code>Intelij Idea</code> -&gt; <code>Preferences</code> -&gt; <code>Plugins</code> -&gt;<br><code>Browers Repositrories</code>ï¼Œæœç´¢<code>visualvm</code>ï¼Œé€‰æ‹©<code>install</code>ï¼šå®‰è£…æˆåŠŸåä¼šæ·»åŠ <code>visualvm</code>çš„å¯åŠ¨é€‰é¡¹ï¼Œå¯åŠ¨ Tomcat çš„åŒæ—¶ä¼šæ‰“å¼€ä¸€ä¸ª<code>VisualVM</code>çš„çª—å£ã€‚</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202212290933918.png\"></p>\n<p>2ã€ä¸é€šè¿‡æ’ä»¶ç›´æ¥å¯åŠ¨ï¼Œä¸æœ¬åœ° Tomcat è”è°ƒï¼Œéœ€è¦é…ç½®ä¸€ä¸‹ Tomcatï¼Œæ·»åŠ å‚æ•°ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">-Dcom.sun.management.jmxremote.port&#x3D;8999\n-Dcom.sun.management.jmxremote.ssl&#x3D;false\n-Dcom.sun.management.jmxremote.authenticate&#x3D;false<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre></li>\n</ul>\n<h1 id=\"3ã€è‡ªé€ æ¡ˆå‘ç°åœº\"><a href=\"#3ã€è‡ªé€ æ¡ˆå‘ç°åœº\" class=\"headerlink\" title=\"3ã€è‡ªé€ æ¡ˆå‘ç°åœº\"></a>3ã€è‡ªé€ æ¡ˆå‘ç°åœº</h1><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>ä¸ºäº†å¿«é€ŸéªŒè¯æˆ‘ä»¬çš„å·¥å…·ä»¥åŠåŠ æ·±å¯¹ OOM çš„ç†è§£ï¼Œæˆ‘ä»¬è‡ªé€ å‡ ç§å†…å­˜æº¢å‡ºåœºæ™¯ï¼Œä»£ç æˆ‘å·²å‡†å¤‡å¦¥å½“ï¼Œå¯ä»¥ç›´æ¥å¤åˆ¶è¿è¡ŒéªŒè¯ï¼Œå¼€å§‹å‰è®°å¾—æ ¹æ®ç¤ºä¾‹è°ƒæ•´ JVM å‚æ•°~</p></blockquote>\n<ul>\n<li><p>PermGen OOM</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token comment\">/**\n * @program: jvisualvmDemo\n * @description: jdk1.7æ°¸ä¹…åŒºå†…å­˜æº¢å‡º\n * -XX:MaxPermSize=5m\n * -XX:+HeapDumpOnOutOfMemoryError\n * -XX:HeapDumpPath=/Users/anchor/Downloads/dump/\n * @author: Anchor\n * @create: 2018-07-31\n **/</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PermGenOOM</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token class-name\">Enhancer</span> enhancer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Enhancer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            enhancer<span class=\"token punctuation\">.</span><span class=\"token function\">setSuperclass</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MetaOOM<span class=\"token punctuation\">.</span>OOMObject</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            enhancer<span class=\"token punctuation\">.</span><span class=\"token function\">setUseCache</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            enhancer<span class=\"token punctuation\">.</span><span class=\"token function\">setCallback</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">MethodInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                <span class=\"token keyword\">public</span> <span class=\"token class-name\">Object</span> <span class=\"token function\">intercept</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Object</span> obj<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Method</span> method<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">,</span> <span class=\"token class-name\">MethodProxy</span> proxy<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Throwable</span> <span class=\"token punctuation\">&#123;</span>\n                    <span class=\"token keyword\">return</span> proxy<span class=\"token punctuation\">.</span><span class=\"token function\">invokeSuper</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">&#125;</span>\n            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//æ— é™åˆ›å»ºåŠ¨æ€ä»£ç†ï¼Œç”ŸæˆClasså¯¹è±¡</span>\n            enhancer<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">OOMObject</span> <span class=\"token punctuation\">&#123;</span>\n\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</li>\n<li><p>MetaOOM</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token comment\">/**\n * @program: jvisualvmDemo\n * @description: æ–¹æ³•åŒºå†…å­˜å¼‚å¸¸\n * -XX:MetaspaceSize=8m\n * -XX:MaxMetaspaceSize=8m\n * -XX:+HeapDumpOnOutOfMemoryError\n * -XX:HeapDumpPath=/Users/anchor/Downloads/dump/\n * @author: Anchor\n * @create: 2018-07-27\n **/</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MetaOOM</span> <span class=\"token punctuation\">&#123;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token class-name\">Enhancer</span> enhancer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Enhancer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            enhancer<span class=\"token punctuation\">.</span><span class=\"token function\">setSuperclass</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">OOMObject</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            enhancer<span class=\"token punctuation\">.</span><span class=\"token function\">setUseCache</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            enhancer<span class=\"token punctuation\">.</span><span class=\"token function\">setCallback</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">MethodInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                <span class=\"token keyword\">public</span> <span class=\"token class-name\">Object</span> <span class=\"token function\">intercept</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Object</span> obj<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Method</span> method<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">,</span> <span class=\"token class-name\">MethodProxy</span> proxy<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Throwable</span> <span class=\"token punctuation\">&#123;</span>\n                    <span class=\"token keyword\">return</span> proxy<span class=\"token punctuation\">.</span><span class=\"token function\">invokeSuper</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">&#125;</span>\n            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//æ— é™åˆ›å»ºåŠ¨æ€ä»£ç†ï¼Œç”ŸæˆClasså¯¹è±¡</span>\n            enhancer<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">OOMObject</span> <span class=\"token punctuation\">&#123;</span>\n\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</li>\n<li><p>HeapOOM</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token comment\">/**\n * @program: jvisualvmDemo\n * @description: å †å†…å­˜å¼‚å¸¸\n * VM Args:\n *     //è¿™ä¸¤ä¸ªå‚æ•°ä¿è¯äº†å †ä¸­çš„å¯åˆ†é…å†…å­˜å›ºå®šä¸º20M\n *     -Xms20m\n *     -Xmx20m\n *     -XX:+HeapDumpOnOutOfMemoryError\n *     -XX:HeapDumpPath=/Users/anchor/Downloads/dump/\n * @author: Anchor\n * @create: 2018-07-27\n **/</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HeapOOM</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token comment\">//åˆ›å»ºä¸€ä¸ªå†…éƒ¨ç±»ç”¨äºåˆ›å»ºå¯¹è±¡ä½¿ç”¨</span>\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">OOMObject</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">OOMObject</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">OOMObject</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//æ— é™åˆ›å»ºå¯¹è±¡ï¼Œåœ¨å †ä¸­</span>\n        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">OOMObject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</li>\n<li><p>JavaVMStackSOF</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token comment\">/**\n * @program: jvisualvmDemo\n * @description: æ ˆå†…å­˜å¼‚å¸¸\n * VM Argsï¼š\n *     //è®¾ç½®æ ˆå®¹é‡ä¸º160Kï¼Œé»˜è®¤1M\n *    -Xss160k\n * @author: Anchor\n * @create: 2018-07-27\n **/</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JavaVMStackSOF</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> stackLength <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">stackLeak</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        stackLength<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//é€’å½’è°ƒç”¨ï¼Œè§¦å‘å¼‚å¸¸</span>\n        <span class=\"token function\">stackLeak</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Throwable</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token class-name\">JavaVMStackSOF</span> oom <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JavaVMStackSOF</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span>\n            oom<span class=\"token punctuation\">.</span><span class=\"token function\">stackLeak</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Throwable</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stack length:\"</span> <span class=\"token operator\">+</span> oom<span class=\"token punctuation\">.</span>stackLength<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">throw</span> e<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>\n</ul>\n<h1 id=\"4ã€æ¡ˆä¾‹åˆ†æ\"><a href=\"#4ã€æ¡ˆä¾‹åˆ†æ\" class=\"headerlink\" title=\"4ã€æ¡ˆä¾‹åˆ†æ\"></a>4ã€æ¡ˆä¾‹åˆ†æ</h1><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>å•°é‡Œå•°å—¦è¿™ä¹ˆç»ˆäºè¦è¿›å…¥æ­£é¢˜äº† ğŸ˜¹</p></blockquote>\n<p>å‡†å¤‡ç¯å¢ƒï¼Œæµ‹è¯•è„šæœ¬</p>\n<p>æ ¹æ®æœ¬åœ°æœºå™¨æ€§èƒ½é…ç½® JVM å‚æ•°ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">-server -XX:PermSize&#x3D;256M -XX:MaxPermSize&#x3D;256m -Xms300M -Xmx300M\n-Dcom.sun.management.jmxremote.port&#x3D;8999\n-Dcom.sun.management.jmxremote.ssl&#x3D;false\n-Dcom.sun.management.jmxremote.authenticate&#x3D;false<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å‡†å¤‡æµ‹è¯•è„šæœ¬ï¼š</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\">#!/usr/bin/env python3</span>\n<span class=\"token comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"token keyword\">from</span> multiprocessing <span class=\"token keyword\">import</span> Process<span class=\"token punctuation\">,</span>Pool\n<span class=\"token keyword\">import</span> os<span class=\"token punctuation\">,</span>time\n<span class=\"token keyword\">import</span> requests\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">run_proc</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">30000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        postdata <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">'code'</span><span class=\"token punctuation\">:</span> i<span class=\"token punctuation\">&#125;</span>\n        r <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span><span class=\"token string\">\"http://localhost:8080/OOM.do\"</span><span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span>postdata<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span><span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Run the main process (%s).'</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>getpid<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    mainStart <span class=\"token operator\">=</span> time<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    p <span class=\"token operator\">=</span> Pool<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        p<span class=\"token punctuation\">.</span>apply_async<span class=\"token punctuation\">(</span>run_proc<span class=\"token punctuation\">,</span>args<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Process'</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Waiting for all subprocesses done ...'</span><span class=\"token punctuation\">)</span>\n    p<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    p<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'All subprocesses done'</span><span class=\"token punctuation\">)</span>\n    mainEnd <span class=\"token operator\">=</span> time<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'All process ran %0.2f seconds.'</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>mainEnd<span class=\"token operator\">-</span>mainStart<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å†…å­˜å¿«ç…§åˆ†æ</p>\n<p>å¿«ç…§å¯¼å…¥ visualvmï¼Œç®€å•ç¿»äº†ä¸€ä¸‹å¾ˆå¿«å‘ç°é—®é¢˜ï¼Œå†…å­˜ä¸­å­˜åœ¨å¤§é‡ SQL ç‰‡æ®µæœªå›æ”¶ï¼Œå¦‚å›¾ï¼š</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202212290934440.png\"></p>\n<p>ä¸ºä½•å†…å­˜ä¼šè¢«å¤§é‡ SQL ç‰‡æ®µå é¢†ï¼Œè«éï¼Ÿï¼Ÿï¼Ÿæœæ–­å¼€å¯æ–­è¨€ï¼ˆççŒœï¼‰æ¨¡å¼ï¼Œæˆ‘ä»¬è¦å¤ç°é—®é¢˜ï¼</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>å‡è®¾ Aï¼šä½¿ç”¨äº†é™æ€å˜é‡å®šä¹‰ SQL ç‰‡æ®µï¼Œå¯¼è‡´èµ„æºæœªå›æ”¶<br>ç¿»ä»£ç ç¡®è®¤ï¼Œå‘ç° SQL ä½¿ç”¨ String å¯¹è±¡æ‹¼æ¥ï¼Œéé™æ€å˜é‡ï¼Œä½†æ˜¯è¯¥ SQL è¿›è¡Œäº†ä¸Šç™¾æ¬¡çš„æ‹¼æ¥å¿…ç„¶é€ æˆèµ„æºæµªè´¹åŠ é‡ GC è´Ÿæ‹…,æœ‰ä¼˜åŒ–ç©ºé—´æ”¹ StringBuildï¼Œæµ‹è¯•ä¹‹ã€‚</p></blockquote>\n<p>è„šæœ¬è·‘èµ·æ¥~ Emm~~ è²Œä¼¼æ²¡å•¥æ•ˆæœ</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>å‡è®¾ Bï¼šè¿æ¥æ± ä¸å¤Ÿç”¨ï¼Ÿ</p></blockquote>\n<p>ç¿»ä»£ç ç¡®è®¤ï¼Œå‘ç°é…ç½®æ­£å¸¸ï¼Œæ”¹å°è¿æ¥æ± å¤§å°ï¼Œæµ‹è¯•ä¹‹ï¼Œæ— æ•ˆã€‚</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>å‡è®¾ Cï¼šæ•°æ®åº“æœ‰æ­»é”ï¼Ÿ</p></blockquote>\n<p>ä½†æ˜¯ä¸è¿ç»´ç¡®è®¤æ¯æ¬¡å†…å­˜æº¢å‡ºåªéœ€é‡å¯åº”ç”¨å³å¯æ¢å¤ï¼Œæ•°æ®åº“æ— éœ€æ“ä½œï¼ŒPASS</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>å‡è®¾ Dï¼šã€‚ã€‚ã€‚ã€‚ã€‚</p></blockquote>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>å‡è®¾ Xï¼šéš¾é“ Druid è¿æ¥æ± ä¼šå¯¼è‡´å†…å­˜æº¢å‡ºï¼Ÿ</p></blockquote>\n<p>æ£€æŸ¥ Druid é…ç½®ï¼Œå‘ç°ä»£ç ä¸­é™¤äº†ä½¿ç”¨äº†è¿æ¥æ± è¿˜é…ç½®äº† SQL ç›‘æ§ï¼ŒURL ç›‘æ§ï¼Œé‚£ä¹ˆç›‘æ§æ•°æ®å­˜å‚¨åœ¨å“ªé‡Œäº†ï¼Ÿéš¾é“é»˜è®¤æ˜¯å†…å­˜ä¸­ï¼Ÿç™¾åº¦ Google æ— æœï¼Œç›´æ¥åŠ¨æ‰‹å‹æµ‹ï¼Œæ¨¡æ‹Ÿ 50W è¯·æ±‚ï¼Œå¾—åˆ°å¦‚ä¸‹æ•°æ®ï¼šæˆåŠŸçš„çœ‹åˆ°äº†å†…å­˜æº¢å‡ºã€‚</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202212290935297.png\"></p>\n<p>å¯¹æ¯”ç”Ÿäº§æœºå†…å­˜å¿«ç…§ï¼Œå‘ç°æœ‰æˆï¼ç»„æˆç»“æœåŸºæœ¬ä¸€è‡´ï¼Œå¯æ˜¯æ²¡é“ç†å•Šï¼Œéš¾åº¦ Druid è¿˜æœ‰è¿™ç§å¤§å‘ï¼Ÿä¸è¡Œä¸æ•¢ç¡®å®šï¼Œé‚£ä¹ˆæˆ‘ä»¬åå‘éªŒè¯ä¸‹ï¼Œå¦‚æœæˆ‘å…³æ‰ Druid çš„ç›‘æ§å‘¢ï¼Ÿè¯´å¹²å°±å¹²ï¼Œå†è·‘ 50W è¯·æ±‚ï¼š</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202212290935142.png\"></p>\n<p>æ¬§å…‹ï¼Œæœç„¶æœ‰ç‚¹æ„æ€ï¼ŒOOM æ¶ˆå¤±äº†(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§</p>\n<p>æ—¢ç„¶é—®é¢˜æ‰¾åˆ°äº†ï¼Œé‚£ä¹ˆå°±è¦åˆ†æä¸ºå•¥ä¼šå‡ºç°è¿™ç§å¤§å‘ï¼Œå…ˆä»å®˜ç½‘å…¥æ‰‹ï¼Œç¿»ä¸‹ Druid çš„ lssues å‘ç°ç«Ÿç„¶æœ‰å‰è¾ˆå·²ç»é—®è¿‡è¯¥ç±»é—®é¢˜</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202212290936633.png\"></p>\n<p>butï¼Œå®˜æ–¹å¹¶æœªå›å¤ï¼Œé‚£ä¹ˆçœ‹èµ·æ¥è¿™ä¸ªé—®é¢˜å¤ª lowï¼Ÿ</p>\n<p>Emmâ€¦. é‚£è‡ªå·±ç ”ç©¶ä¸‹å¥½äº†</p>\n<p>è¿›ä¸€æ­¥æ‰©å±•</p>\n<p>ç¿»é˜…å®˜æ–¹æ–‡æ¡£ï¼Œ <a href=\"https://github.com/alibaba/druid/wiki/%E9%85%8D%E7%BD%AE_StatFilter\">åœ¨ SQL åˆå¹¶é…ç½®</a> ï¼Œå‘ç°å¦‚ä¸‹å†…å®¹ï¼š</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>å½“ä½ ç¨‹åºä¸­å­˜åœ¨æ²¡æœ‰å‚æ•°åŒ–çš„ sql æ‰§è¡Œæ—¶ï¼Œsql ç»Ÿè®¡çš„æ•ˆæœä¼šä¸å¥½ã€‚æ¯”å¦‚ï¼š<br>select _ from t where id &#x3D; 1<br>select _ from t where id &#x3D; 2<br>select _ from t where id &#x3D; 3<br>åœ¨ç»Ÿè®¡ä¸­ï¼Œæ˜¾ç¤ºä¸º 3 æ¡ sqlï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬å¸Œæœ›è¦çš„æ•ˆæœã€‚StatFilter æä¾›åˆå¹¶çš„åŠŸèƒ½ï¼Œèƒ½å¤Ÿå°†è¿™ 3 ä¸ª SQL åˆå¹¶ä¸ºå¦‚ä¸‹çš„ SQL<br>select _ from t where id &#x3D; ?</p></blockquote>\n<p>é—®é¢˜åˆ°æ­¤å·²ç»åŸºæœ¬æ˜äº†ï¼Œä¸è§„èŒƒçš„å…¥å‚å¯¼è‡´<code>StatFilter</code>æœªèƒ½æˆåŠŸåˆå¹¶ SQLï¼ŒDruid æˆåŠŸè®°å½•äº†æ‰€æœ‰çš„æ‰§è¡Œè¯­å¥ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p>\n<p>å¤§å®¶å¯ä»¥è‡ªè¡Œä½“ä¼šä¸‹è¿™ä¸¤ç§å†™æ³•çš„åŒºåˆ«ï¼š</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202212290936538.png\"></p>\n<h1 id=\"5ã€å†…å­˜æº¢å‡ºæ’æŸ¥æ€»ç»“\"><a href=\"#5ã€å†…å­˜æº¢å‡ºæ’æŸ¥æ€»ç»“\" class=\"headerlink\" title=\"5ã€å†…å­˜æº¢å‡ºæ’æŸ¥æ€»ç»“\"></a>5ã€å†…å­˜æº¢å‡ºæ’æŸ¥æ€»ç»“</h1><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>å¯¼è‡´ OutOfMemoryError å¼‚å¸¸çš„å¸¸è§åŸå› æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p>\n<pre><code>   - å†…å­˜ä¸­åŠ è½½çš„æ•°æ®é‡è¿‡äºåºå¤§ï¼Œå¦‚ä¸€æ¬¡ä»æ•°æ®åº“å–å‡ºè¿‡å¤šæ•°æ®ï¼›\n   - é›†åˆç±»ä¸­æœ‰å¯¹å¯¹è±¡çš„å¼•ç”¨ï¼Œä½¿ç”¨å®Œåæœªæ¸…ç©ºï¼Œä½¿å¾—JVMä¸èƒ½å›æ”¶ï¼›\n   - ä»£ç ä¸­å­˜åœ¨æ­»å¾ªç¯æˆ–å¾ªç¯äº§ç”Ÿè¿‡å¤šé‡å¤çš„å¯¹è±¡å®ä½“ï¼›\n   - ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹è½¯ä»¶ä¸­çš„BUGï¼›\n   - å¯åŠ¨å‚æ•°å†…å­˜å€¼è®¾å®šçš„è¿‡å°ï¼›\n   - ç¼–ç ä¸è§„èŒƒçš„éšæ‚£ï¼›\n</code></pre></blockquote>\n","feature":true,"text":"0ã€èµ·å›  ä¸€å°éƒ¨ç½²äºå•†æˆ·ç§æœ‰äº‘ä¸­çš„åº”ç”¨é¢‘ç¹å®•æœºï¼Œç»æŸ¥ä¸º OOMï¼Œå‘¨æœŸå¤§çº¦ä¸€å‘¨ä¸€æ¬¡ï¼Œè¾ƒè§„å¾‹ï¼Œæ‰€è°“åƒé‡Œä¹‹å ¤æ¯äºèšç©´ï¼Œåˆæ­¥æ€€ç–‘æ˜¯è½»å¾®çš„å†…å­˜æ³„æ¼ä¸æ–­ç§¯ç´¯å¯¼è‡´çš„å†…å­˜æº¢å‡ºï¼Œæ‰€ä»¥å†æ¬¡å®•æœºå‡ºç°æ—¶æœæ–­ dump å†…å­˜é•œåƒå¼€å§‹åˆ†æ 1ã€å†…å­˜æº¢å‡ºåŸç† å¸¸è§å†…å­˜æº¢å‡ºï¼š ç›¸ä¿¡é€šè¿‡å†™ java ç¨‹åºè®¨ç”Ÿæ´»çš„...","link":"","photos":[],"count_time":{"symbolsCount":"8k","symbolsTime":"7 mins."},"categories":[{"name":"JAVA","slug":"JAVA","count":7,"path":"api/categories/JAVA.json"}],"tags":[{"name":"JVM","slug":"JVM","count":2,"path":"api/tags/JVM.json"},{"name":"OOM","slug":"OOM","count":2,"path":"api/tags/OOM.json"},{"name":"Druid","slug":"Druid","count":1,"path":"api/tags/Druid.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#0%E3%80%81%E8%B5%B7%E5%9B%A0\"><span class=\"toc-text\">0ã€èµ·å› </span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#1%E3%80%81%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA%E5%8E%9F%E7%90%86\"><span class=\"toc-text\">1ã€å†…å­˜æº¢å‡ºåŸç†</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#2%E3%80%81%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA%E6%97%B6%E5%BA%94%E8%AF%A5%E5%81%9A%E4%BB%80%E4%B9%88\"><span class=\"toc-text\">2ã€å†…å­˜æº¢å‡ºæ—¶åº”è¯¥åšä»€ä¹ˆ</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#3%E3%80%81%E8%87%AA%E9%80%A0%E6%A1%88%E5%8F%91%E7%8E%B0%E5%9C%BA\"><span class=\"toc-text\">3ã€è‡ªé€ æ¡ˆå‘ç°åœº</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#4%E3%80%81%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90\"><span class=\"toc-text\">4ã€æ¡ˆä¾‹åˆ†æ</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#5%E3%80%81%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA%E6%8E%92%E6%9F%A5%E6%80%BB%E7%BB%93\"><span class=\"toc-text\">5ã€å†…å­˜æº¢å‡ºæ’æŸ¥æ€»ç»“</span></a></li></ol>","author":{"name":"Anchor","slug":"blog-author","avatar":"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202212281657361.png","link":"/","description":"æ–°ç”Ÿä»£å†œæ°‘å·¥ <br /> æŠ€æœ¯æ— äº§é˜¶çº§ <br /> æµªæµªå±±æ‰“å·¥äºº <br /> @ <b>TGï¼šAlihai5</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Mybatisä¸€çº§ç¼“å­˜å¯¼è‡´çš„å†…å­˜æº¢å‡º","uid":"d8253a8b0f6101721f69eb1f7316985f","slug":"Java/Mybatisä¸€çº§ç¼“å­˜å¯¼è‡´çš„å†…å­˜æº¢å‡º","date":"2018-09-29T12:06:29.000Z","updated":"2022-12-29T02:21:21.894Z","comments":true,"path":"api/articles/Java/Mybatisä¸€çº§ç¼“å­˜å¯¼è‡´çš„å†…å­˜æº¢å‡º.json","keywords":"é˜¿é‡Œå­©èˆ,äº”æœˆè¥¿æ©,Anchor,é˜æ¥¼éº»é›€,ç å†œ,ç¨‹åºçŒ¿,JAVA","cover":"/medias/dva.jpg","text":" æ¥ä¸Šç¯‡ Druid ç›‘æ§å¯¼è‡´çš„å†…å­˜æº¢å‡ºé—®é¢˜å®šä½å¤„ç† JVM å†…å­˜æº¢å‡ºç›¸å…³ï¼ŒåºŸè¯ä¸å¤šè¯´ç›´æ¥ä¸Šåˆ†æè¿‡ç¨‹ã€‚ 1ã€æœåŠ¡å™¨å†…å­˜å¿«ç…§åˆ†æ é¦–å…ˆé€šè¿‡å¿«ç…§æŸ¥çœ‹æœ€å¤§çš„äºŒåä¸ªå¯¹è±¡å¦‚ä¸‹å›¾ï¼š æ ¹æ®åé¦ˆæ•°æ®å¯ä»¥å‘ç°å‰åä¸ªå¯¹è±¡å¤§å°åŸºæœ¬å·®ä¸å¤šï¼ŒçŒœæµ‹åº”è¯¥ç”±ä¸€ä¸ªé—®é¢˜å¯¼è‡´ï¼Œç‚¹å‡»å»è¿›ä¸€æ­¥å®šä½é—®é¢˜ã€‚ 2ã€å®šä½å¼•èµ·å†…å­˜...","link":"","photos":[],"count_time":{"symbolsCount":"2.8k","symbolsTime":"3 mins."},"categories":[{"name":"JAVA","slug":"JAVA","count":7,"path":"api/categories/JAVA.json"}],"tags":[{"name":"JVM","slug":"JVM","count":2,"path":"api/tags/JVM.json"},{"name":"OOM","slug":"OOM","count":2,"path":"api/tags/OOM.json"},{"name":"Mybatis","slug":"Mybatis","count":1,"path":"api/tags/Mybatis.json"}],"author":{"name":"Anchor","slug":"blog-author","avatar":"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202212281657361.png","link":"/","description":"æ–°ç”Ÿä»£å†œæ°‘å·¥ <br /> æŠ€æœ¯æ— äº§é˜¶çº§ <br /> æµªæµªå±±æ‰“å·¥äºº <br /> @ <b>TGï¼šAlihai5</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"æµªæµªå±±æ‰“å·¥äººæ—…æ¸¸æŒ‡å—ï¼ˆä¸€ï¼‰Java é¢è¯•é¢˜ã€æ±‡æ€»ç¯‡ã€‘","uid":"c498ccbc5dc4c0c1651c7cd1edb0e954","slug":"æµªæµªå±±æ‰“å·¥äºº/æµªæµªå±±æ‰“å·¥äººæ—…æ¸¸æŒ‡å—ï¼ˆä¸€ï¼‰Java é¢è¯•é¢˜ã€æ±‡æ€»ç¯‡ã€‘","date":"2023-01-16T13:58:28.000Z","updated":"2023-01-22T05:07:55.951Z","comments":true,"path":"api/articles/æµªæµªå±±æ‰“å·¥äºº/æµªæµªå±±æ‰“å·¥äººæ—…æ¸¸æŒ‡å—ï¼ˆä¸€ï¼‰Java é¢è¯•é¢˜ã€æ±‡æ€»ç¯‡ã€‘.json","keywords":"é˜¿é‡Œå­©èˆ,äº”æœˆè¥¿æ©,Anchor,é˜æ¥¼éº»é›€,ç å†œ,ç¨‹åºçŒ¿,JAVA","cover":"/medias/lls.jpg","text":" 2023å¹´1æœˆä»½æœ€æ–°åŸºç¡€æ±‡æ€»ç¯‡ï¼ŒJavaå¼€å‘æŠ€æœ¯æ ˆçŸ¥è¯†ç‚¹éƒ½æœ‰æ¶‰åŠï¼Œä¸»è¦é¢å‘1-2å¹´ä¿®ä¸ºçš„æµªæµªå±±å°å¦–ï¼Œæ¸©æ•…è€ŒçŸ¥æ–°æ—…æ¸¸å‰è¯»è¿™ä¸€ç¯‡å°±å¤Ÿäº† ä¸€ã€åŸºç¡€ç¯‡1.1.Javaè¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹ ç®€å•æ˜“å­¦ã€æœ‰ä¸°å¯Œçš„ç±»åº“ é¢å‘å¯¹è±¡ï¼ˆJavaæœ€é‡è¦çš„ç‰¹æ€§ï¼Œè®©ç¨‹åºè€¦åˆåº¦æ›´ä½ï¼Œå†…èšæ€§æ›´é«˜ï¼‰ ä¸å¹³å°æ— å…³æ€§ï¼ˆJ...","link":"","photos":[],"count_time":{"symbolsCount":"59k","symbolsTime":"54 mins."},"categories":[{"name":"æµªæµªå±±æ‰“å·¥äºº","slug":"æµªæµªå±±æ‰“å·¥äºº","count":2,"path":"api/categories/æµªæµªå±±æ‰“å·¥äºº.json"}],"tags":[{"name":"JAVA","slug":"JAVA","count":4,"path":"api/tags/JAVA.json"},{"name":"JavaåŸºç¡€","slug":"JavaåŸºç¡€","count":3,"path":"api/tags/JavaåŸºç¡€.json"},{"name":"Javaé¢è¯•é¢˜","slug":"Javaé¢è¯•é¢˜","count":2,"path":"api/tags/Javaé¢è¯•é¢˜.json"},{"name":"2023æ±‡æ€»ç¯‡","slug":"2023æ±‡æ€»ç¯‡","count":1,"path":"api/tags/2023æ±‡æ€»ç¯‡.json"}],"author":{"name":"Anchor","slug":"blog-author","avatar":"https://cdn.jsdelivr.net/gh/heyshoop/imageRepository@master/images/202212281657361.png","link":"/","description":"æ–°ç”Ÿä»£å†œæ°‘å·¥ <br /> æŠ€æœ¯æ— äº§é˜¶çº§ <br /> æµªæµªå±±æ‰“å·¥äºº <br /> @ <b>TGï¼šAlihai5</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}